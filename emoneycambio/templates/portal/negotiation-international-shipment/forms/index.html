<form id="form-step" class="form-step" action="">
    <input type="hidden" name="nextstep" id="nextstep" value="1">

    <span class="breadcumb">
        <a href="/remessa-internacional" rel="noopener noreferrer"><b>Filtros</b></a>
    </span>
    
    <div class="container-coin">
        <img src="{{ url_for('static', filename='icons/coin.png') }}" alt="Moeda" width="24" height="24"/>
        <select name="coin" id="coin" class="filter-select coin">
            <option value="" disabled>Moeda</option>
            <option value="dolar-americano">Dólar americano</option>
            <option value="dolar-canadense">Dólar canadense</option>
            <option value="euro">Euro</option>
            <option value="libra">Libra</option>
            <option value="libra">Outros</option>
        </select>
    </div>

    <div class="radio-toolbar">
        <input type="radio" name="person_type" id="person_type_pf" value="PF" checked>
        <label for="person_type_pf">PF</label>

        <input type="radio" name="person_type" id="person_type_pj" value="PJ">
        <label for="person_type_pj">PJ</label>
    </div>

    <div class="radio-toolbar">
        <input type="radio" name="transaction" id="transaction_send" value="enviar" checked onclick="changeFeeValue('enviar')">
        <label for="transaction_send">Enviar</label>

        <input type="radio" name="transaction" id="transaction_receive" value="receber" onclick="changeFeeValue('receber')">
        <label for="transaction_receive">Receber</label>
    </div>
    
    <div class="container-input-step">
        <div class="input-step">
            <label class="text-font-style" for="value" id="value"> Quantos  <b id="coin-text">Reais</b> quer <b id="transaction-text">enviar</b> ?</label>
            <input id="money" class="input-step-text" type="text" name="value">
        </div>

        <div class="input-step">
            <div class="info-fee text-font-style">Valor com taxas <img src="{{ url_for('static', filename='icons/info.png') }}" alt="Moeda" width="24" height="24"/>
                <span class="tooltiptext" style="font-size: 12px; color:red">Valores podem estar desatualizados</span>
            </div>
           
            <span class="subtitle-font-style" id="fee_value_tmp">$ {{allowed_company.company.coin.dispatch_international_shipment_fee}}</span>
            <input type="hidden" name="fee_value" id="fee_value" value="{{allowed_company.company.coin.dispatch_international_shipment_fee}}">
        </div>

        <span class="msg-calc text-font-style">Total à <b id="transaction-text">receber</b> em <span class="subtitle-font-style" id="coin-text">Dólar americano</span>:<br> <i class="subtitle-font-style"> $ <span id="dynamic-total-value">0</span></i></span>

    </div>
    <input class="button" type="button" value="Continuar" onclick="nextStepFormCustom(event)">
</form>
<script>
    $("#coin").change(function(e){
        console.log($(this).find('option:selected').text())
    })

    function changeFeeValue(transaction) {
        
        var data = {{ allowed_company|tojson|safe }};
        if (transaction == 'receber'){
            $("span#fee_value_tmp").text("$ "+{{allowed_company.company.coin.receipt_international_shipment_fee}})
            $("input#fee_value").val("$ "+{{allowed_company.company.coin.receipt_international_shipment_fee}})
        }
        else{
            $("span#fee_value_tmp").text("$ "+{{allowed_company.company.coin.dispatch_international_shipment_fee}})
            $("input#fee_value").val("$ "+{{allowed_company.company.coin.dispatch_international_shipment_fee}})
        }

        let currentValue = onlyNumbers($("#money").val())
        let feeValue = onlyNumbers($('input#fee_value').val())
        let newValue = parseFloat((currentValue/100) * (feeValue/100)).toFixed(2);
        $("#dynamic-total-value").text(newValue)
     }

</script>